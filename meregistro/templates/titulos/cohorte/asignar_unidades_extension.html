{% extends "base_titulos.html" %}

{% block title %}Asignar la cohorte a unidades de extensión{% endblock %}

{% load tags_filters %}

{% block css_body_classes %}
{% css_classes "cohorte-asignar-unidades-extension" %}
{% endblock %}

{% block content %}
<h2>Asignar la cohorte a unidades de extensión</h2>

<form action="" method="get">
    <div class="form-filter" id="cohorteAsignarUnidadesExtensionFormFilter">
	<h3>Búsqueda avanzada</h3>
	{{ form_filters.non_field_errors }}
	<div class="form-select">
	    {{ form_filters.dependencia_funcional.errors }}
	    <label for="id_dependencia_funcional">Dependencia funcional:</label>
	    {{ form_filters.dependencia_funcional }}
	</div>
	<div class="form-select">
	    {{ form_filters.localidad.errors }}
	    <label for="id_localidad">Localidad:</label>
	    {{ form_filters.localidad }}
	</div>
	<div class="form-text">
	    {{ form_filters.cue.errors }}
	    <label for="id_cue">CUE:</label>
	    {{ form_filters.cue }}
	</div>
	<div class="form-text">
	    {{ form_filters.nombre.errors }}
	    <label for="id_nombre">Nombre:</label>
	    {{ form_filters.nombre }}
	</div>
	<div class="form-submit">
		<input type="submit" value="Buscar" />
		<input type="button" value="Reiniciar" onclick="window.location = '/titulos/cohorte/{{ cohorte.id }}/asignar-unidades-extension';" />
	</div>
    </div>
</form>

{% include "titulos/cohorte/datos_cohorte.html" %}

{% if objects %}
<form action="" method="post">{% csrf_token %}
    <table class="hor-zebra">
	<thead>
	    <tr>
		<th><input type="checkbox" name="check_all_unidades_extension" id="check_all_unidades_extension" /></th>
		<th id="thEstablecimientoCue">CUE</th>
		<th>Unidad de extensión</th>
		<th>Nombre</th>
		<th>Oferta</th>
		<th>Departamento</th>
		<th>Localidad</th>
	    </tr>
	</thead>
	<tbody>
	{% for unidad_extension in objects %}
	    <tr class="{% cycle 'hor-zebra' 'hor-zebra_odd' %}">
		<td><input type="checkbox" name="unidades_extension" value="{{ unidad_extension.id }}"{% if unidad_extension.id in current_unidades_extension_ids %} checked="checked"{% endif%} /></td>
		<td>{{ unidad_extension.establecimiento.cue }}</td>
		<td>{{ unidad_extension.cue }}</td>
		<td>{{ unidad_extension.nombre }}</td>
		<td><input type="checkbox" name="oferta" value="{{ unidad_extension.id }}"{% if unidad_extension.id in current_unidades_extension_oferta %} checked="checked"{% endif%} /></td>
		<td>{{ unidad_extension.unidad_extension_domicilio.get.localidad.departamento }}</td>
		<td>{{ unidad_extension.unidad_extension_domicilio.get.localidad }}</td>
	    </tr>
	{% endfor %}
	</tbody>
    </table>
    <div class="form-submit" style="margin-top: 20px;">
	<input type="submit" value="Asignar unidades de extensión seleccionadas" />
    </div>
</form>
<script type="text/javascript">
// init
unidad_extension_checked = false;
unidad_extension_checkboxes = $('input[name="unidades_extension"][type="checkbox"]');
$('#check_all_unidades_extension').checked = false;
$('#check_all_unidades_extension').attr('checked', unidad_extension_checked);
$('#check_all_unidades_extension').click(function(){
    unidad_extension_checked = !unidad_extension_checked;
    unidad_extension_checkboxes.attr('checked', unidad_extension_checked);
});
</script>

{% else %}
<div class="message warning">
	<p>No se encontraron unidades de extensión.</p>
</div>
{% endif %}
<ul class="actions">
    <li class="back">
        <a href="{% url apps.titulos.views.cohorte.cohortes_por_titulo cohorte.titulo_jurisdiccional_id %}"><span>Volver</span></a>
    </li>
</ul>
<hr />
{% endblock %}
